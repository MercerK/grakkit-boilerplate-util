(()=>{var e={507:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.format=t.circular=t.array=void 0;const r=n(595),o=r.type("java.lang.Class"),s=r.type("java.lang.Iterable"),a=r.type("java.util.Iterator"),i=r.type("java.util.Spliterator");function c(e){if(e instanceof Array)return[...e];if(e instanceof s){const t=[];return e.forEach((e=>{t.push(e)})),t}if(e instanceof a||e instanceof i){const t=[];return e.forEachRemaining((e=>{t.push(e)})),t}return null}t.array=c,t.circular=Symbol(),t.format={error(e){let t="Error",n=`${e}`;if(e.stack)switch(t=e.stack.split("\n")[0].split(" ")[0].slice(0,-1),n=e.message,t){case"TypeError":try{if(n.startsWith("invokeMember")||n.startsWith("execute on foreign object")){const e=n.split("failed due to: ")[1];n=e.startsWith("no applicable overload found")?["Invalid arguments! Expected:",...e.split("overloads:")[1].split("]],")[0].split(")]").map((e=>`(${e.split("(").slice(1).join("(")})`))].join("\n -> ").slice(0,-1):e.startsWith("Arity error")?`Invalid argument amount! Expected: ${e.split("-")[1].split(" ")[2]}`:e.startsWith("UnsupportedTypeException")?"Invalid arguments!":e.startsWith("Unknown identifier")?`That method (${e.split(": ")[1]}) does not exist!`:e.startsWith("Message not supported")?`That method (${n.slice(14).split(")")[0]}) does not exist!`:n.split("\n")[0]}}catch(e){n=n.split("\n")[0]}break;case"SyntaxError":n=n.split(" ").slice(1).join(" ").split("\n")[0]}else t=(e=`${e}`).split(" ")[0].slice(0,-1),n=e.split(" ").slice(1).join(" ");return`${t}: ${n}`},output(e,n){if(!0===n){if(e===t.circular)return"...";{const t=toString.call(e);switch(t){case"[object Array]":case"[object Object]":case"[object Function]":return t.split(" ")[1].slice(0,-1);case"[foreign HostObject]":if(e instanceof o&&"function"==typeof e.getCanonicalName)return e.getCanonicalName();if("function"==typeof e.toString){const t=e.toString();if(t)return t}const n="function"==typeof e.getClass?e.getClass():e.class;return n instanceof o&&"function"==typeof n.getCanonicalName?n.getCanonicalName():`${e}`||`${n}`||"Object";case"[foreign HostFunction]":return"Function";default:switch(typeof e){case"bigint":return e.toString()+"n";case"function":return"Function";case"object":return e?"Object":"null";case"symbol":return`<${e.toString().slice(7,-1)}>`;case"undefined":return"undefined";default:return JSON.stringify(e)}}}}else switch(toString.call(e)){case"[object Array]":return`[ ${[...e].map((n=>t.format.output(e===n?t.circular:n,!0))).join(", ")} ]`;case"[object Object]":return`{ ${[...Object.getOwnPropertyNames(e).map((n=>`${n}: ${t.format.output(e===e[n]?t.circular:e[n],!0)}`)),...Object.getOwnPropertySymbols(e).map((n=>`${t.format.output(n,!0)}: ${t.format.output(e===e[n]?t.circular:e[n],!0)}`))].join(", ")} }`;case"[object Function]":return e instanceof o&&"function"==typeof e.getCanonicalName?e.getCanonicalName():"function"==typeof e.toString?r.regex.replace(e.toString(),"\\r",""):`${e}`||"function () { [native code] }";case"[foreign HostFunction]":return"hostFunction () { [native code] }";default:const n=c(e);return n?t.format.output(n):t.format.output(e,!0)}}},r.command({name:"js",permission:"grakkit.command.js",message:"Â§cYou do not have the required permission to run this command!",execute(e,...n){const o=globalThis.hasOwnProperty("self");let s;o||(globalThis.self=e);try{const e=Polyglot.eval("js",n.join(" "));o||delete globalThis.self,s=t.format.output(e)}catch(e){o||delete globalThis.self,s=t.format.error(e)}switch(r.env.name){case"bukkit":case"minestom":e.sendMessage(s)}},tabComplete(e,...t){let n="",o=-1,s=globalThis,a=!0,i=!1,c=!1,l=!1,u="";const p=t.join(" ");for(;a&&++o<p.length;){const t=p[o];if(l)"*"===t&&"/"===p[o+1]&&(u?";"===p[o+2]&&(l=!1):(n=p.slice(0,o+2),l=!1));else if(i)"\\"===t?++o:t===i&&(s={},i=!1);else if(!0===c)["'",'"',"`"].includes(t)?c=t:a=!1;else if("string"==typeof c)switch(t){case"\\":++o;break;case c:c=-1;break;default:u+=t}else switch(t){case"/":switch(p[o+1]){case"/":a=!1;break;case"*":l=!0}break;case"'":case'"':case"`":-1===c?a=!1:i=t;break;case")":case"{":case"}":c||(s={});break;case".":case"[":c||("."===t||u?(n=p.slice(0,o+1),s=s!==globalThis||"self"!==u||s.hasOwnProperty("self")?s[u]||{}:e,"."===t||(c=!0),u=""):(n=p.slice(0,o+1),s=globalThis));break;case"]":-1===c&&(c=!1);break;case"\\":"string"==typeof c?++o:a=!1;break;case" ":u?a=!1:n="";break;default:r.regex.test(t,"[\\+\\-\\*\\/\\^=!&\\|\\?:\\(,;]")?c||(n=p.slice(0,o+1),s=globalThis,u=""):u+=t}}if(a&&s&&!l&&!i){const e=[...Object.getOwnPropertyNames(s.constructor&&s.constructor.prototype||{}),...Object.getOwnPropertyNames(s)];return s===globalThis&&!e.includes("self")&&e.push("self"),e.sort().filter((e=>e.toLowerCase().includes(u.toLowerCase()))).filter((e=>c||r.regex.test(e,"[_A-Za-z$][_0-9A-Za-z$]*"))).map((e=>c?`${n}\`${r.regex.replace(e,"`","\\`").split("\\").join("\\\\")}\`]`:`${n}${e}`))}return[]}})},595:(e,t)=>{"use strict";if(Object.defineProperty(t,"__esModule",{value:!0}),t.sync=t.simplify=t.root=t.reload=t.regex=t.push=t.load=t.file=t.fetch=t.event=t.env=t.data=t.context=t.task=t.command=t.chain=t.async=t.type=t.session=void 0,"Grakkit"in globalThis)Object.assign(globalThis,{Core:Grakkit});else{if(!("Core"in globalThis))throw"Grakkit was not detected in your current environment!";Object.assign(globalThis,{Grakkit:Core})}function n(e){if(t.session.type.has(e))return t.session.type.get(e);{const n=Java.type(e);return t.session.type.set(e,n),n}}t.session={data:new Map,event:new Map,load:new Map,poly:{index:0,list:new Map},task:{list:new Set,tick:0},type:new Map},t.type=n;const r=n("java.nio.file.Files"),o=n("java.lang.String"),s=n("java.nio.file.Paths"),a=n("java.util.regex.Pattern"),i=n("java.util.Scanner"),c=n("java.net.URL"),l=n("java.util.UUID");function u(e,t){const n=e=>t(e,n);return n(e)}function p(e,...n){e="string"==typeof e?e:"io"in e?e.path:e.getPath();const a=s.get(e,...n).normalize().toFile(),i={get children(){return"folder"===i.type?[...a.listFiles()].map((e=>p(e.getPath()))):null},directory:()=>("none"===i.type&&u(a,((e,t)=>{const n=e.getParentFile();n&&(n.exists()||t(n)),e.mkdir()})),i),entry:()=>("none"===i.type&&i.parent.directory()&&a.createNewFile(),i),get exists(){return a.exists()},file:(...e)=>p(a,...e),flush:()=>(u(a,((e,t)=>{const n=e.getParentFile();n&&n.isDirectory()&&(n.listFiles()[0]||n.delete()&&t(n))})),i),io:a,json(e){if(e)return i.read(!0).then((e=>JSON.parse(e)));try{return JSON.parse(i.read())}catch(e){return null}},get name(){return a.getName()},get parent(){return i.file("..")},get path(){return t.regex.replace(a.getPath(),"(\\\\)","/")},read:e=>e?new Promise((async e=>{const n=l.randomUUID().toString();t.context.on(n).then((t=>{e(t)})),t.context.create("file",`${g}/async.js`,JSON.stringify({path:i.path,operation:"file.read",uuid:n})).open()})):"file"===i.type?new o(r.readAllBytes(a.toPath())).toString():null,remove:()=>(u(a,((e,t)=>{e.isDirectory()&&[...e.listFiles()].forEach(t),e.exists()&&e.delete()})),i.flush()),get type(){return a.isDirectory()?"folder":a.exists()?"file":"none"},write:(e,n)=>n?new Promise((async n=>{const r=l.randomUUID().toString();t.context.on(r).then((()=>{n(i)})),t.context.create("file",`${g}/async.js`,JSON.stringify({content:e,path:i.path,operation:"file.write",uuid:r})).open()})):("file"===i.type&&r.write(a.toPath(),new o(e).getBytes()),i)};return i}function f(e){Grakkit.push(e)}function d(e,t,n){if(e&&"object"==typeof e){if(n||(n=new Set),n.has(e))return t;{n.add(e);const r="function"==typeof e[Symbol.iterator]?[]:{};for(const o in e)r[o]=d(e[o],t,new Set(n));return r}}return e}t.async=function(e){switch(t.env.name){case"bukkit":return new Promise(((n,r)=>{t.env.content.server.getScheduler().runTaskAsynchronously(t.env.content.plugin,new t.env.content.Runnable((async()=>{try{n(await e())}catch(e){r(e)}})))}));case"minestom":return new Promise((async(t,n)=>{try{t(await e())}catch(e){n(e)}}))}},t.chain=u,t.command=function(e){switch(t.env.name){case"bukkit":t.env.content.plugin.register(e.namespace||t.env.content.plugin.getName(),e.name,e.aliases||[],e.permission||"",e.message||"",((t,n,r)=>{try{!e.permission||t.hasPermission(e.permission)?e.execute&&e.execute(t,...r):t.sendMessage(e.message||"")}catch(e){console.error(`An error occured while attempting to execute the "${n}" command!`),console.error(e.stack||e.message||e)}}),((t,n,r)=>{try{return e.tabComplete&&e.tabComplete(t,...r)||[]}catch(e){return console.error(`An error occured while attempting to tab-complete the "${n}" command!`),console.error(e.stack||e.message||e),[]}}));break;case"minestom":{const n=new t.env.content.Command(e.name);n.addSyntax(((t,n)=>{try{e.execute&&e.execute(t,...n.getInput().split(" ").slice(1))}catch(t){console.error(`An error occured while attempting to execute the "${e.name}" command!`),console.error(t.stack||t.message||t)}}),t.env.content.ArgumentType.StringArray("tab-complete").setSuggestionCallback(((n,r,o)=>{for(const s of e.tabComplete(n,...r.getInput().split(" ").slice(1))||[])o.addEntry(new t.env.content.SuggestionEntry(s))}))),t.env.content.registry.register(n)}}},t.task={cancel(e){t.session.task.list.delete(e)},interval(e,n=0,...r){const o=t.task.timeout(((...t)=>{o.tick+=Math.ceil(n<1?1:n),e(...t)}),0,...r);return o},timeout(e,n=0,...r){const o={tick:t.session.task.tick+Math.ceil(n<0?0:n),args:r,script:e};return t.session.task.list.add(o),o}},t.context=(()=>{try{const e=Grakkit.getMeta();return{create:(e,t,n)=>Grakkit[`${e}Instance`](t,n),destroy(){Grakkit.destroy()},emit(e,t){Grakkit.emit(e,t)},meta:e,off:(e,t)=>Grakkit.off(e,t),on:(e,t)=>t?Grakkit.on(e,t):Grakkit.on(e)}}catch(e){const n={},r=[];return t.task.interval((()=>{for(const e of r.splice(0,r.length))if(e.channel in n)for(const t of n[e.channel])try{t(e.content)}catch(e){console.error("An error occured while attempting to listen for a message!"),console.error(e.stack||e.message||e)}})),{create(){throw"Your current version of Grakkit does not support creating new contexts!"},destroy(){throw"The primary instance cannot be destroyed!"},emit(e,t){r.push({channel:e,content:t})},meta:"grakkit",off(e,t){if(e in n){const r=n[e];r.includes(t)&&r.splice(r.indexOf(t),1)}},on:(e,r)=>{if(!r)return new Promise((n=>{const r=o=>{t.context.off(e,r),n(o)};t.context.on(e,r)}));n[e]||(n[e]=[]).push(r)}}}})(),t.data=function(e,...n){const r=s.get(e,...n).normalize().toString();if(t.session.data.has(r))return t.session.data.get(r);{const e=p(t.root,"data",`${r}.json`).json()||{};return t.session.data.set(r,e),e}},t.env=(()=>{try{const e=n("org.bukkit.Bukkit"),t=e.getPluginManager(),r=t.getPlugin("grakkit");return Grakkit.hook((()=>{n("org.bukkit.event.HandlerList").unregisterAll(r)})),{content:{EventPriority:n("org.bukkit.event.EventPriority"),instance:new(Java.extend(n("org.bukkit.event.Listener"),{})),manager:t,plugin:r,Runnable:n("java.lang.Runnable"),server:e.getServer()},name:"bukkit"}}catch(e){try{const e=n("net.minestom.server.MinecraftServer"),t=e.getExtensionManager(),r=t.getExtension("grakkit");return{content:{ArgumentType:n("net.minestom.server.command.builder.arguments.ArgumentType"),Command:n("net.minestom.server.command.builder.Command"),extension:r,manager:t,node:r.getEventNode(),registry:e.getCommandManager(),server:e,SuggestionEntry:n("net.minestom.server.command.builder.suggestion.SuggestionEntry")},name:"minestom"}}catch(e){return{name:"unknown",content:{}}}}})(),t.event=function(e,...r){switch(t.env.name){case"bukkit":{let o;t.session.event.has(e)?o=t.session.event.get(e):(o=new Set,t.session.event.set(e,o));const s=new Set;for(const e of r)"function"==typeof e?s.has("HIGHEST")||s.add("HIGHEST"):s.has(e.priority)||s.add(e.priority);for(const e of o)"function"==typeof e?s.has("HIGHEST")&&s.delete("HIGHEST"):s.has(e.priority)&&s.delete(e.priority);for(const r of s){const s=n(e);t.env.content.manager.registerEvent(s.class,t.env.content.instance,t.env.content.EventPriority.valueOf(r),((t,n)=>{if(n instanceof s)try{for(const e of o)"function"==typeof e?"HIGHEST"===r&&e(n):r===e.priority&&e.script(n)}catch(t){console.error(`An error occured while attempting to handle the "${e}" event!`),console.error(t.stack||t.message||t)}}),t.env.content.plugin)}for(const e of r)o.has(e)||o.add(e)}break;case"minestom":{let o;if(t.session.event.has(e)?o=t.session.event.get(e):(o=new Set,t.session.event.set(e,o)),0===o.size){const r=n(e);t.env.content.node.addListener(r.class,(t=>{try{for(const e of o)"function"==typeof e?e(t):e.script(t)}catch(t){console.error(`An error occured while attempting to handle the "${e}" event!`),console.error(t.stack||t.message||t)}}))}for(const e of r)o.has(e)||o.add(e)}}},t.fetch=function(e){const n={json(e){if(e)return n.read(!0).then((e=>JSON.parse(e)));try{return JSON.parse(n.read())}catch(e){throw e}},read:r=>r?new Promise((async n=>{const r=l.randomUUID().toString();t.context.on(r).then((e=>{n(e)})),t.context.create("file",`${g}/async.js`,JSON.stringify({link:e,operation:"fetch.read",uuid:r})).open()})):new i(n.stream()).useDelimiter("\\A").next(),stream:()=>new c(e).openStream()};return n},t.file=p,t.load=function(e,n){if(t.session.load.has(n))return t.session.load.get(n);{const r=p(e);if(r.exists){const e=Grakkit.load(r.io,n);return t.session.load.set(n,e),e}throw new ReferenceError(`The file "${r.path}" does not exist!`)}},t.push=f,t.regex={test:(e,t)=>e.matches(t),replace:(e,t,n)=>a.compile(t).matcher(e).replaceAll(n)},t.reload=function(){f(Grakkit.swap)},t.root=p(Grakkit.getRoot()),t.simplify=d,t.sync=function(e){return new Promise(((t,n)=>{Grakkit.sync((()=>e().then(t).catch(n)))}))},u(void 0,((e,n)=>{Grakkit.push(n);for(const e of t.session.task.list)if(t.session.task.tick>e.tick)t.session.task.list.delete(e);else if(t.session.task.tick===e.tick)try{e.script(...e.args)}catch(e){console.error("An error occured while attempting to execute a task!"),console.error(e.stack||e.message||e)}++t.session.task.tick})),Grakkit.hook((()=>{for(const[e]of t.session.data)p(t.root,"data",`${e}.json`).entry().write(JSON.stringify(d(t.session.data.get(e))))}));const g="/",m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h=Promise.resolve();Object.assign(globalThis,{atob(e){var n=t.regex.replace(String(e),"[=]+$","");if(n.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,o,s=0,a=0,i="";o=n.charAt(a++);~o&&(r=s%4?64*r+o:o,s++%4)?i+=String.fromCharCode(255&r>>(-2*s&6)):0)o=m.indexOf(o);return i},btoa(e){for(var t,n,r=String(e),o=0,s=m,a="";r.charAt(0|o)||(s="=",o%1);a+=s.charAt(63&t>>8-o%1*8)){if((n=r.charCodeAt(o+=3/4))>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");t=t<<8|n}return a},clearImmediate(e){t.task.cancel(t.session.poly.list.get(e))},clearInterval(e){t.task.cancel(t.session.poly.list.get(e))},clearTimeout(e){t.task.cancel(t.session.poly.list.get(e))},queueMicrotask(e){h.then(e).catch((e=>{t.task.timeout((()=>{throw e}))}))},setInterval:(e,n=0,...r)=>(t.session.poly.list.set(t.session.poly.index,t.task.interval("string"==typeof e?()=>Polyglot.eval("js",e):e,Math.ceil(n/50),...r)),t.session.poly.index++),setTimeout:(e,n=0,...r)=>(t.session.poly.list.set(t.session.poly.index,t.task.timeout("string"==typeof e?()=>Polyglot.eval("js",e):e,Math.ceil(n/50),...r)),t.session.poly.index++),setImmediate:(e,...n)=>(t.session.poly.list.set(t.session.poly.index,t.task.timeout("string"==typeof e?()=>Polyglot.eval("js",e):e,0,...n)),t.session.poly.index++)})},780:(e,t,n)=>{const r=n(604);"grakkit"===r.context.meta&&n(507);const o={manager:r.env.content.manager,plugin:r.env.content.plugin,server:r.env.content.server},s=Object.assign({},r,o);Object.assign(globalThis,o,{core:s}),e.exports=s},604:(e,t)=>{"use strict";if(Object.defineProperty(t,"__esModule",{value:!0}),t.sync=t.simplify=t.root=t.reload=t.regex=t.push=t.load=t.file=t.fetch=t.event=t.env=t.data=t.context=t.task=t.command=t.chain=t.desync=t.type=t.session=void 0,"Grakkit"in globalThis)Object.assign(globalThis,{Core:Grakkit});else{if(!("Core"in globalThis))throw"Polyglot"in globalThis?"Grakkit was not detected (or is very outdated) in your environment!":"Java"in globalThis?"GraalJS was not detected in your environment!":"Java was not detected in your environment!";Object.assign(globalThis,{Grakkit:Core})}function n(e){if(t.session.type.has(e))return t.session.type.get(e);{const n=Java.type(e);return t.session.type.set(e,n),n}}t.session={data:new Map,event:new Map,load:new Map,poly:{index:0,list:new Map},task:{list:new Set,tick:0},type:new Map},t.type=n;const r=n("java.nio.file.Files"),o=n("java.lang.String"),s=n("java.nio.file.Paths"),a=n("java.util.regex.Pattern"),i=n("java.util.Scanner"),c=n("java.net.URL"),l=n("java.util.UUID");function u(e,t){const n=e=>t(e,n);return n(e)}function p(e,...n){e="string"==typeof e?e:"io"in e?e.path:e.getPath();const a=s.get(e,...n).normalize().toFile(),i={get children(){return"folder"===i.type?[...a.listFiles()].map((e=>p(e.getPath()))):null},directory:()=>("none"===i.type&&u(a,((e,t)=>{const n=e.getParentFile();n&&(n.exists()||t(n)),e.mkdir()})),i),entry:()=>("none"===i.type&&i.parent.directory()&&a.createNewFile(),i),get exists(){return a.exists()},file:(...e)=>p(a,...e),flush:()=>(u(a,((e,t)=>{const n=e.getParentFile();n&&n.isDirectory()&&(n.listFiles()[0]||n.delete()&&t(n))})),i),io:a,json(e){if(e)return i.read(!0).then((e=>JSON.parse(e)));try{return JSON.parse(i.read())}catch(e){return null}},get name(){return a.getName()},get parent(){return i.file("..")},get path(){return t.regex.replace(a.getPath(),"(\\\\)","/")},read:e=>e?t.desync.request(g,{operation:"file.read",path:i.path}):"file"===i.type?new o(r.readAllBytes(a.toPath())).toString():null,remove:()=>(u(a,((e,t)=>{e.isDirectory()&&[...e.listFiles()].forEach(t),e.exists()&&e.delete()})),i.flush()),get type(){return a.isDirectory()?"folder":a.exists()?"file":"none"},write:(e,n)=>n?t.desync.request(g,{content:e,operation:"file.write",path:i.path}).then((()=>i)):("file"===i.type&&r.write(a.toPath(),new o(e).getBytes()),i)};return i}function f(e){Grakkit.push(e)}function d(e,t,n){if(e&&"object"==typeof e){if(n||(n=new Set),n.has(e))return t;{n.add(e);const r="function"==typeof e[Symbol.iterator]?[]:{};for(const o in e)r[o]=d(e[o],t,new Set(n));return r}}return e}t.desync={async provide(e){try{const{data:n,uuid:r}=JSON.parse(t.context.meta);try{t.context.emit(r,JSON.stringify({data:await e(n),status:!0}))}catch(e){t.context.emit(r,JSON.stringify({data:e,status:!1}))}}catch(e){throw"The current context's metadata is incompatible with the desync system!"}},async request(e,n={}){if(p(e).exists){const r=l.randomUUID().toString(),o=t.context.on(r);t.context.create("file",p(e).io.getAbsolutePath(),JSON.stringify({data:n,uuid:r})).open();const s=JSON.parse(await o);if(s.status)return s.data;throw s.data}throw"That file does not exist!"},shift(e){switch(t.env.name){case"bukkit":return new Promise(((n,r)=>{t.env.content.server.getScheduler().runTaskAsynchronously(t.env.content.plugin,new t.env.content.Runnable((async()=>{try{n(await e())}catch(e){r(e)}})))}));case"minestom":return new Promise((async(t,n)=>{try{t(await e())}catch(e){n(e)}}))}}},t.chain=u,t.command=function(e){switch(t.env.name){case"bukkit":t.env.content.plugin.register(e.namespace||t.env.content.plugin.getName(),e.name,e.aliases||[],e.permission||"",e.message||"",((t,n,r)=>{try{!e.permission||t.hasPermission(e.permission)?e.execute&&e.execute(t,...r):t.sendMessage(e.message||"")}catch(e){console.error(`An error occured while attempting to execute the "${n}" command!`),console.error(e.stack||e.message||e)}}),((t,n,r)=>{try{return e.tabComplete&&e.tabComplete(t,...r)||[]}catch(e){return console.error(`An error occured while attempting to tab-complete the "${n}" command!`),console.error(e.stack||e.message||e),[]}}));break;case"minestom":{const n=new t.env.content.Command(e.name);n.addSyntax(((t,n)=>{try{e.execute&&e.execute(t,...n.getInput().split(" ").slice(1))}catch(t){console.error(`An error occured while attempting to execute the "${e.name}" command!`),console.error(t.stack||t.message||t)}}),t.env.content.ArgumentType.StringArray("tab-complete").setSuggestionCallback(((n,r,o)=>{for(const s of e.tabComplete(n,...r.getInput().split(" ").slice(1))||[])o.addEntry(new t.env.content.SuggestionEntry(s))}))),t.env.content.registry.register(n)}}},t.task={cancel(e){t.session.task.list.delete(e)},interval(e,n=0,...r){const o=t.task.timeout(((...t)=>{o.tick+=Math.ceil(n<1?1:n),e(...t)}),0,...r);return o},timeout(e,n=0,...r){const o={tick:t.session.task.tick+Math.ceil(n<0?0:n),args:r,script:e};return t.session.task.list.add(o),o}},t.context=(()=>{try{return{create:(e,t,n)=>Grakkit[`${e}Instance`](t,n),destroy(){Grakkit.destroy()},emit(e,t){Grakkit.emit(e,t)},meta:Grakkit.getMeta(),off:(e,t)=>Grakkit.off(e,t),on:(e,n)=>n?Grakkit.on(e,n):new Promise((n=>{const r=o=>{t.context.off(e,r),n(o)};t.context.on(e,r)})),swap(){f(Grakkit.swap)}}}catch(e){const n={},r=[];return t.task.interval((()=>{for(const e of r.splice(0,r.length))if(e.channel in n)for(const t of n[e.channel])try{t(e.content)}catch(e){console.error("An error occured while attempting to listen for a message!"),console.error(e.stack||e.message||e)}})),{create(){throw"Your current version of Grakkit does not support creating new contexts!"},destroy(){throw"The primary instance cannot be destroyed!"},emit(e,t){r.push({channel:e,content:t})},meta:"grakkit",off(e,t){if(e in n){const r=n[e];r.includes(t)&&r.splice(r.indexOf(t),1)}},on:(e,r)=>{if(!r)return new Promise((n=>{const r=o=>{t.context.off(e,r),n(o)};t.context.on(e,r)}));n[e]||(n[e]=[]).push(r)},swap(){f(Grakkit.swap)}}}})(),t.data=function(e,...n){const r=s.get(e,...n).normalize().toString();if(t.session.data.has(r))return t.session.data.get(r);{const e=p(t.root,"data",`${r}.json`).json()||{};return t.session.data.set(r,e),e}},t.env=(()=>{try{const e=n("org.bukkit.Bukkit"),t=e.getPluginManager(),r=t.getPlugin("grakkit");return Grakkit.hook((()=>{n("org.bukkit.event.HandlerList").unregisterAll(r)})),{content:{EventPriority:n("org.bukkit.event.EventPriority"),instance:new(Java.extend(n("org.bukkit.event.Listener"),{})),manager:t,plugin:r,Runnable:n("java.lang.Runnable"),server:e.getServer()},name:"bukkit"}}catch(e){try{const e=n("net.minestom.server.MinecraftServer"),t=e.getExtensionManager(),r=t.getExtension("grakkit");return{content:{ArgumentType:n("net.minestom.server.command.builder.arguments.ArgumentType"),Command:n("net.minestom.server.command.builder.Command"),extension:r,manager:t,node:r.getEventNode(),registry:e.getCommandManager(),server:e,SuggestionEntry:n("net.minestom.server.command.builder.suggestion.SuggestionEntry")},name:"minestom"}}catch(e){return{name:"unknown",content:{}}}}})(),t.event=function(e,...r){switch(t.env.name){case"bukkit":{let o;t.session.event.has(e)?o=t.session.event.get(e):(o=new Set,t.session.event.set(e,o));const s=new Set;for(const e of r)"function"==typeof e?s.has("HIGHEST")||s.add("HIGHEST"):s.has(e.priority)||s.add(e.priority);for(const e of o)"function"==typeof e?s.has("HIGHEST")&&s.delete("HIGHEST"):s.has(e.priority)&&s.delete(e.priority);for(const r of s){const s=n(e);t.env.content.manager.registerEvent(s.class,t.env.content.instance,t.env.content.EventPriority.valueOf(r),((t,n)=>{if(n instanceof s)try{for(const e of o)"function"==typeof e?"HIGHEST"===r&&e(n):r===e.priority&&e.script(n)}catch(t){console.error(`An error occured while attempting to handle the "${e}" event!`),console.error(t.stack||t.message||t)}}),t.env.content.plugin)}for(const e of r)o.has(e)||o.add(e)}break;case"minestom":{let o;if(t.session.event.has(e)?o=t.session.event.get(e):(o=new Set,t.session.event.set(e,o)),0===o.size){const r=n(e);t.env.content.node.addListener(r.class,(t=>{try{for(const e of o)"function"==typeof e?e(t):e.script(t)}catch(t){console.error(`An error occured while attempting to handle the "${e}" event!`),console.error(t.stack||t.message||t)}}))}for(const e of r)o.has(e)||o.add(e)}}},t.fetch=function(e){const n={json(e){if(e)return n.read(!0).then((e=>JSON.parse(e)));try{return JSON.parse(n.read())}catch(e){throw e}},read:r=>r?t.desync.request(g,{link:e,operation:"fetch.read"}):new i(n.stream()).useDelimiter("\\A").next(),stream:()=>new c(e).openStream()};return n},t.file=p,t.load=function(e,n){if(t.session.load.has(n))return t.session.load.get(n);{const r=p(e);if(r.exists){const e=Grakkit.load(r.io,n);return t.session.load.set(n,e),e}throw new ReferenceError(`The file "${r.path}" does not exist!`)}},t.push=f,t.regex={test:(e,t)=>e.matches(t),replace:(e,t,n)=>a.compile(t).matcher(e).replaceAll(n)},t.reload=function(){f(Grakkit.reload||Grakkit.swap)},t.root=p(Grakkit.getRoot()),t.simplify=d,t.sync=function(e){return new Promise(((t,n)=>{Grakkit.sync((()=>e().then(t).catch(n)))}))},u(void 0,((e,n)=>{Grakkit.push(n);for(const e of t.session.task.list)if(t.session.task.tick>e.tick)t.session.task.list.delete(e);else if(t.session.task.tick===e.tick)try{e.script(...e.args)}catch(e){console.error("An error occured while attempting to execute a task!"),console.error(e.stack||e.message||e)}++t.session.task.tick})),Grakkit.hook((()=>{for(const[e]of t.session.data)p(t.root,"data",`${e}.json`).entry().write(JSON.stringify(d(t.session.data.get(e))))}));const g="//async.js",m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h=Promise.resolve();Object.assign(globalThis,{atob(e){var n=t.regex.replace(String(e),"[=]+$","");if(n.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,o,s=0,a=0,i="";o=n.charAt(a++);~o&&(r=s%4?64*r+o:o,s++%4)?i+=String.fromCharCode(255&r>>(-2*s&6)):0)o=m.indexOf(o);return i},btoa(e){for(var t,n,r=String(e),o=0,s=m,a="";r.charAt(0|o)||(s="=",o%1);a+=s.charAt(63&t>>8-o%1*8)){if((n=r.charCodeAt(o+=3/4))>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");t=t<<8|n}return a},clearImmediate(e){t.task.cancel(t.session.poly.list.get(e))},clearInterval(e){t.task.cancel(t.session.poly.list.get(e))},clearTimeout(e){t.task.cancel(t.session.poly.list.get(e))},queueMicrotask(e){h.then(e).catch((e=>{t.task.timeout((()=>{throw e}))}))},setInterval:(e,n=0,...r)=>(t.session.poly.list.set(t.session.poly.index,t.task.interval("string"==typeof e?()=>Polyglot.eval("js",e):e,Math.ceil(n/50),...r)),t.session.poly.index++),setTimeout:(e,n=0,...r)=>(t.session.poly.list.set(t.session.poly.index,t.task.timeout("string"==typeof e?()=>Polyglot.eval("js",e):e,Math.ceil(n/50),...r)),t.session.poly.index++),setImmediate:(e,...n)=>(t.session.poly.list.set(t.session.poly.index,t.task.timeout("string"==typeof e?()=>Polyglot.eval("js",e):e,0,...n)),t.session.poly.index++)})}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};(()=>{"use strict";n.r(r),n.d(r,{WebServer:()=>u,formatWebpackMessages:()=>s,initializeAutoReload:()=>p});var e="Syntax error:";function t(t){return-1!==t.indexOf(e)}function o(t){var n=[];return"string"==typeof t?n=t.split("\n"):"message"in t?n=t.message.split("\n"):Array.isArray(t)&&t.forEach((e=>{"message"in e&&(n=e.message.split("\n"))})),t=(t=(t=(t=(t=(n=(n=n.filter((e=>!/Module [A-z ]+\(from/.test(e)))).map((t=>{var n=/Line (\d+):(?:(\d+):)?\s*Parsing error: (.+)$/.exec(t);if(!n)return t;var[,r,o,s]=n;return"".concat(e," ").concat(s," (").concat(r,":").concat(o,")")}))).join("\n")).replace(/SyntaxError\s+\((\d+):(\d+)\)\s*(.+?)\n/g,"".concat(e," $3 ($1:$2)\n"))).replace(/^.*export '(.+?)' was not found in '(.+?)'.*$/gm,"Attempted import error: '$1' is not exported from '$2'.")).replace(/^.*export 'default' \(imported as '(.+?)'\) was not found in '(.+?)'.*$/gm,"Attempted import error: '$2' does not contain a default export (imported as '$1').")).replace(/^.*export '(.+?)' \(imported as '(.+?)'\) was not found in '(.+?)'.*$/gm,"Attempted import error: '$1' is not exported from '$3' (imported as '$2')."),(n=t.split("\n")).length>2&&""===n[1].trim()&&n.splice(1,1),n[0]=n[0].replace(/^(.*) \d+:\d+-\d+$/,"$1"),n[1]&&0===n[1].indexOf("Module not found: ")&&(n=[n[0],n[1].replace("Error: ","").replace("Module not found: Cannot find file:","Cannot find file:")]),t=(t=(t=n.join("\n")).replace(/^\s*at\s((?!webpack:).)*:\d+:\d+[\s)]*(\n|$)/gm,"")).replace(/^\s*at\s<anonymous>(\n|$)/gm,""),n=t.split("\n"),(t=(n=n.filter(((e,t,n)=>0===t||""!==e.trim()||e.trim()!==n[t-1].trim()))).join("\n")).trim()}function s(e){var n={errors:e.errors.map(o),warnings:e.warnings.map(o)};return n.errors.some(t)&&(n.errors=n.errors.filter(t)),n}var a=n(780);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=c((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}));function p(){u.start(),console.log("Grakkit-Boilerplate-Util: Production Mode")}l(u,"app",void 0),l(u,"start",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"java-express-0.0.10.jar",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"express.Express";if(!u.app){var n=a.core.load("./plugins/grakkit/".concat(e),t);if(!n)throw new Error('Unable to load "'.concat(e,'" in the "plugins/grakkit" folder.'));var r=new n;r.use(((e,t,n)=>{t.setHeader("Access-Control-Allow-Origin","*")})),u.app=r}})),l(u,"stop",(()=>{u.app&&u.app.stop()})),l(u,"listen",(e=>{if(!u.app)throw new Error("WebServer is not active.");return u.app.listen(e)})),l(u,"get",((e,t)=>{if(!u.app)throw new Error("WebServer is not active.");return u.app.get(e,t)}))})(),exports.test=r})();
//# sourceMappingURL=index.js.map